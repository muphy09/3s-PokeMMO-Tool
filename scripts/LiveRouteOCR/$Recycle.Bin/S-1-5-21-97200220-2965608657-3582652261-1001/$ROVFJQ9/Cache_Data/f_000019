import { createHotContext as __vite__createHotContext } from "/@vite/client";import.meta.hot = __vite__createHotContext("/src/components/OptionsMenu.jsx");import __vite__cjsImport0_react_jsxDevRuntime from "/node_modules/.vite/deps/react_jsx-dev-runtime.js?v=5e085948"; const jsxDEV = __vite__cjsImport0_react_jsxDevRuntime["jsxDEV"];
import * as RefreshRuntime from "/@react-refresh";
const inWebWorker = typeof WorkerGlobalScope !== "undefined" && self instanceof WorkerGlobalScope;
let prevRefreshReg;
let prevRefreshSig;
if (import.meta.hot && !inWebWorker) {
  if (!window.$RefreshReg$) {
    throw new Error(
      "@vitejs/plugin-react can't detect preamble. Something is wrong."
    );
  }
  prevRefreshReg = window.$RefreshReg$;
  prevRefreshSig = window.$RefreshSig$;
  window.$RefreshReg$ = RefreshRuntime.getRefreshReg("C:/dev/pokemmo-tool/src/components/OptionsMenu.jsx");
  window.$RefreshSig$ = RefreshRuntime.createSignatureFunctionForTransform;
}
var _s = $RefreshSig$(), _s2 = $RefreshSig$();
import __vite__cjsImport3_react from "/node_modules/.vite/deps/react.js?v=5e085948"; const React = __vite__cjsImport3_react.__esModule ? __vite__cjsImport3_react.default : __vite__cjsImport3_react; const useEffect = __vite__cjsImport3_react["useEffect"]; const useRef = __vite__cjsImport3_react["useRef"]; const useState = __vite__cjsImport3_react["useState"];
export default function OptionsMenu() {
  _s();
  const [open, setOpen] = useState(false);
  const [toast, setToast] = useState(null);
  const menuRef = useRef(null);
  useEffect(() => {
    const onDoc = (e) => {
      if (menuRef.current && !menuRef.current.contains(e.target)) setOpen(false);
    };
    document.addEventListener("mousedown", onDoc);
    return () => document.removeEventListener("mousedown", onDoc);
  }, []);
  useEffect(() => {
    if (!toast) return;
    const t = setTimeout(() => setToast(null), 2200);
    return () => clearTimeout(t);
  }, [toast]);
  const show = (text, kind = "info") => setToast({ text, kind });
  async function onCheckUpdates() {
    try {
      show("Checking for updates…", "info");
      const current = await window.app?.getVersion?.().catch(() => null);
      const res = await window.app?.checkUpdates?.();
      const status = res?.status || (res?.version ? "available" : "uptodate");
      if (status === "available" && res?.version) {
        show(`Update ${res.version} available — will install on exit.`, "success");
      } else if (status === "uptodate") {
        show(`Up to date${current ? ` (v${current})` : ""}!`, "success");
      } else if (status === "error") {
        show("Update check failed.", "error");
        console.error("[OptionsMenu] checkUpdates error:", res?.message);
      } else {
        show("Up to date!", "success");
      }
    } catch (err) {
      show("Update check failed.", "error");
      console.error("[OptionsMenu] checkUpdates error:", err);
    } finally {
      setOpen(false);
    }
  }
  async function onReloadOCR() {
    try {
      show("Restarting OCR…", "info");
      await window.app?.reloadOCR?.();
      window.dispatchEvent(new CustomEvent("force-live-reconnect", { detail: { reset: true } }));
      show("OCR restarted.", "success");
    } catch (err) {
      show("Failed to restart OCR.", "error");
      console.error("[OptionsMenu] reloadOCR error:", err);
    } finally {
      setOpen(false);
    }
  }
  async function onRefresh() {
    try {
      await window.app?.refreshApp?.();
    } finally {
      setOpen(false);
    }
  }
  const btnStyle = {
    padding: "6px 10px",
    borderRadius: 10,
    border: "1px solid #2a2a2a",
    background: "linear-gradient(180deg,#2b2b2b,#1b1b1b)",
    color: "#eaeaea",
    fontWeight: 700,
    cursor: "pointer",
    boxShadow: "0 4px 16px rgba(0,0,0,.3)"
  };
  const menuStyle = {
    position: "absolute",
    right: 0,
    top: "calc(100% + 6px)",
    minWidth: 220,
    background: "#0e0e0e",
    border: "1px solid #282828",
    borderRadius: 12,
    boxShadow: "0 16px 40px rgba(0,0,0,.45)",
    overflow: "hidden"
  };
  return /* @__PURE__ */ jsxDEV("div", { ref: menuRef, style: { position: "fixed", top: 10, right: 12, zIndex: 9999 }, children: [
    /* @__PURE__ */ jsxDEV(
      "button",
      {
        style: btnStyle,
        onClick: () => setOpen((v) => !v),
        title: "Options",
        "aria-haspopup": "menu",
        "aria-expanded": open,
        children: "Options ▾"
      },
      void 0,
      false,
      {
        fileName: "C:/dev/pokemmo-tool/src/components/OptionsMenu.jsx",
        lineNumber: 127,
        columnNumber: 7
      },
      this
    ),
    open && /* @__PURE__ */ jsxDEV("div", { style: menuStyle, role: "menu", "aria-label": "Options menu", children: [
      /* @__PURE__ */ jsxDEV(MenuItem, { label: "Check for updates", onClick: onCheckUpdates }, void 0, false, {
        fileName: "C:/dev/pokemmo-tool/src/components/OptionsMenu.jsx",
        lineNumber: 139,
        columnNumber: 11
      }, this),
      /* @__PURE__ */ jsxDEV(Divider, {}, void 0, false, {
        fileName: "C:/dev/pokemmo-tool/src/components/OptionsMenu.jsx",
        lineNumber: 140,
        columnNumber: 11
      }, this),
      /* @__PURE__ */ jsxDEV(MenuItem, { label: "Live OCR Setup…", onClick: () => {
        window.dispatchEvent(new Event("open-live-setup"));
        setOpen(false);
      } }, void 0, false, {
        fileName: "C:/dev/pokemmo-tool/src/components/OptionsMenu.jsx",
        lineNumber: 141,
        columnNumber: 11
      }, this),
      /* @__PURE__ */ jsxDEV(MenuItem, { label: "Reload OCR", onClick: onReloadOCR }, void 0, false, {
        fileName: "C:/dev/pokemmo-tool/src/components/OptionsMenu.jsx",
        lineNumber: 142,
        columnNumber: 11
      }, this),
      /* @__PURE__ */ jsxDEV(MenuItem, { label: "Refresh app", onClick: onRefresh }, void 0, false, {
        fileName: "C:/dev/pokemmo-tool/src/components/OptionsMenu.jsx",
        lineNumber: 143,
        columnNumber: 11
      }, this)
    ] }, void 0, true, {
      fileName: "C:/dev/pokemmo-tool/src/components/OptionsMenu.jsx",
      lineNumber: 138,
      columnNumber: 7
    }, this),
    toast && /* @__PURE__ */ jsxDEV(
      "div",
      {
        role: "status",
        "aria-live": "polite",
        style: {
          position: "absolute",
          right: 0,
          top: "calc(100% + 54px)",
          padding: "8px 12px",
          background: toast.kind === "error" ? "#5a1a1a" : toast.kind === "success" ? "#1b4a1b" : "#1a1a3a",
          color: "#eee",
          borderRadius: 10,
          border: "1px solid #333",
          boxShadow: "0 8px 28px rgba(0,0,0,.45)",
          maxWidth: 360,
          pointerEvents: "none",
          fontWeight: 700
        },
        children: toast.text
      },
      void 0,
      false,
      {
        fileName: "C:/dev/pokemmo-tool/src/components/OptionsMenu.jsx",
        lineNumber: 148,
        columnNumber: 7
      },
      this
    )
  ] }, void 0, true, {
    fileName: "C:/dev/pokemmo-tool/src/components/OptionsMenu.jsx",
    lineNumber: 126,
    columnNumber: 5
  }, this);
}
_s(OptionsMenu, "1qaY3Ym8iPS5LV7gBxpmVvYi91Y=");
_c = OptionsMenu;
function MenuItem({ label, onClick }) {
  _s2();
  const [hover, setHover] = useState(false);
  const itemStyle = {
    width: "100%",
    textAlign: "left",
    padding: "10px 12px",
    color: "#ddd",
    background: "transparent",
    border: 0,
    cursor: "pointer",
    fontWeight: 600
  };
  const itemHover = { background: "#1b1b1b" };
  return /* @__PURE__ */ jsxDEV(
    "button",
    {
      role: "menuitem",
      onClick,
      onMouseEnter: () => setHover(true),
      onMouseLeave: () => setHover(false),
      style: { ...itemStyle, ...hover ? itemHover : null },
      children: label
    },
    void 0,
    false,
    {
      fileName: "C:/dev/pokemmo-tool/src/components/OptionsMenu.jsx",
      lineNumber: 192,
      columnNumber: 5
    },
    this
  );
}
_s2(MenuItem, "bRXmKus9fOZFlca/6zXTYU+twGY=");
_c2 = MenuItem;
function Divider() {
  return /* @__PURE__ */ jsxDEV("div", { style: { height: 1, background: "#262626" } }, void 0, false, {
    fileName: "C:/dev/pokemmo-tool/src/components/OptionsMenu.jsx",
    lineNumber: 205,
    columnNumber: 10
  }, this);
}
_c3 = Divider;
var _c, _c2, _c3;
$RefreshReg$(_c, "OptionsMenu");
$RefreshReg$(_c2, "MenuItem");
$RefreshReg$(_c3, "Divider");
if (import.meta.hot && !inWebWorker) {
  window.$RefreshReg$ = prevRefreshReg;
  window.$RefreshSig$ = prevRefreshSig;
}
if (import.meta.hot && !inWebWorker) {
  RefreshRuntime.__hmr_import(import.meta.url).then((currentExports) => {
    RefreshRuntime.registerExportsForReactRefresh("C:/dev/pokemmo-tool/src/components/OptionsMenu.jsx", currentExports);
    import.meta.hot.accept((nextExports) => {
      if (!nextExports) return;
      const invalidateMessage = RefreshRuntime.validateRefreshBoundaryAndEnqueueUpdate("C:/dev/pokemmo-tool/src/components/OptionsMenu.jsx", currentExports, nextExports);
      if (invalidateMessage) import.meta.hot.invalidate(invalidateMessage);
    });
  });
}

//# sourceMappingURL=data:application/json;base64,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QUFFMUIsWUFBWSxVQUFVO0FBQzFDLFNBQ0U7QUFBQSxJQUFDO0FBQUE7QUFBQSxNQUNDLE1BQUs7QUFBQSxNQUNMO0FBQUEsTUFDQSxjQUFjLE1BQU1zQixTQUFTLElBQUk7QUFBQSxNQUNqQyxjQUFjLE1BQU1BLFNBQVMsS0FBSztBQUFBLE1BQ2xDLE9BQU8sRUFBRSxHQUFHQyxXQUFXLEdBQUlGLFFBQVFLLFlBQVksS0FBTTtBQUFBLE1BRXBEUjtBQUFBQTtBQUFBQSxJQVBIO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQVFBO0FBRUo7QUFBQ0UsSUF4QlFILFVBQVE7QUFBQVUsTUFBUlY7QUEwQlQsU0FBU1csVUFBVTtBQUNqQixTQUFPLHVCQUFDLFNBQUksT0FBTyxFQUFFQyxRQUFRLEdBQUc3QixZQUFZLFVBQVUsS0FBL0M7QUFBQTtBQUFBO0FBQUE7QUFBQSxTQUFpRDtBQUMxRDtBQUFDOEIsTUFGUUY7QUFBTyxJQUFBWixJQUFBVyxLQUFBRztBQUFBQyxhQUFBZixJQUFBO0FBQUFlLGFBQUFKLEtBQUE7QUFBQUksYUFBQUQsS0FBQSIsIm5hbWVzIjpbIlJlYWN0IiwidXNlRWZmZWN0IiwidXNlUmVmIiwidXNlU3RhdGUiLCJPcHRpb25zTWVudSIsIl9zIiwib3BlbiIsInNldE9wZW4iLCJ0b2FzdCIsInNldFRvYXN0IiwibWVudVJlZiIsIm9uRG9jIiwiZSIsImN1cnJlbnQiLCJjb250YWlucyIsInRhcmdldCIsImRvY3VtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJ0Iiwic2V0VGltZW91dCIsImNsZWFyVGltZW91dCIsInNob3ciLCJ0ZXh0Iiwia2luZCIsIm9uQ2hlY2tVcGRhdGVzIiwid2luZG93IiwiYXBwIiwiZ2V0VmVyc2lvbiIsImNhdGNoIiwicmVzIiwiY2hlY2tVcGRhdGVzIiwic3RhdHVzIiwidmVyc2lvbiIsImNvbnNvbGUiLCJlcnJvciIsIm1lc3NhZ2UiLCJlcnIiLCJvblJlbG9hZE9DUiIsInJlbG9hZE9DUiIsImRpc3BhdGNoRXZlbnQiLCJDdXN0b21FdmVudCIsImRldGFpbCIsInJlc2V0Iiwib25SZWZyZXNoIiwicmVmcmVzaEFwcCIsImJ0blN0eWxlIiwicGFkZGluZyIsImJvcmRlclJhZGl1cyIsImJvcmRlciIsImJhY2tncm91bmQiLCJjb2xvciIsImZvbnRXZWlnaHQiLCJjdXJzb3IiLCJib3hTaGFkb3ciLCJtZW51U3R5bGUiLCJwb3NpdGlvbiIsInJpZ2h0IiwidG9wIiwibWluV2lkdGgiLCJvdmVyZmxvdyIsInpJbmRleCIsInYiLCJFdmVudCIsIm1heFdpZHRoIiwicG9pbnRlckV2ZW50cyIsIl9jIiwiTWVudUl0ZW0iLCJsYWJlbCIsIm9uQ2xpY2siLCJfczIiLCJob3ZlciIsInNldEhvdmVyIiwiaXRlbVN0eWxlIiwid2lkdGgiLCJ0ZXh0QWxpZ24iLCJpdGVtSG92ZXIiLCJfYzIiLCJEaXZpZGVyIiwiaGVpZ2h0IiwiX2MzIiwiJFJlZnJlc2hSZWckIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VzIjpbIk9wdGlvbnNNZW51LmpzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgdXNlRWZmZWN0LCB1c2VSZWYsIHVzZVN0YXRlIH0gZnJvbSBcInJlYWN0XCI7XG5cbi8qKlxuICogT3B0aW9ucyBkcm9wZG93biB3aXRoIHRvYXN0czpcbiAqICAtIENoZWNrIGZvciB1cGRhdGVzIOKGkiBcIkNoZWNraW5n4oCmXCIsIFwiVXAgdG8gZGF0ZSAodlgpIVwiLCBvciBcIlVwZGF0ZSB2WSBhdmFpbGFibGUg4oCUIHdpbGwgaW5zdGFsbCBvbiBleGl0LlwiXG4gKiAgLSBSZWxvYWQgT0NSICAgICAgICDihpIgcmVzdGFydHMgaGVscGVyIEFORCBzaWduYWxzIExpdmUgdGFiIHRvIHJlY29ubmVjdC9jbGVhclxuICogIC0gUmVmcmVzaCBhcHAgICAgICAg4oaSIGZ1bGwgcmVuZGVyZXIgcmVmcmVzaFxuICovXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBPcHRpb25zTWVudSgpIHtcbiAgY29uc3QgW29wZW4sIHNldE9wZW5dID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbdG9hc3QsIHNldFRvYXN0XSA9IHVzZVN0YXRlKG51bGwpOyAvLyB7IHRleHQsIGtpbmQgfSB8IG51bGxcbiAgY29uc3QgbWVudVJlZiA9IHVzZVJlZihudWxsKTtcblxuICAvLyBjbG9zZSB3aGVuIGNsaWNraW5nIG91dHNpZGVcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBjb25zdCBvbkRvYyA9IChlKSA9PiB7XG4gICAgICBpZiAobWVudVJlZi5jdXJyZW50ICYmICFtZW51UmVmLmN1cnJlbnQuY29udGFpbnMoZS50YXJnZXQpKSBzZXRPcGVuKGZhbHNlKTtcbiAgICB9O1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgb25Eb2MpO1xuICAgIHJldHVybiAoKSA9PiBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIG9uRG9jKTtcbiAgfSwgW10pO1xuXG4gIC8vIGF1dG8taGlkZSB0b2FzdFxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmICghdG9hc3QpIHJldHVybjtcbiAgICBjb25zdCB0ID0gc2V0VGltZW91dCgoKSA9PiBzZXRUb2FzdChudWxsKSwgMjIwMCk7XG4gICAgcmV0dXJuICgpID0+IGNsZWFyVGltZW91dCh0KTtcbiAgfSwgW3RvYXN0XSk7XG5cbiAgY29uc3Qgc2hvdyA9ICh0ZXh0LCBraW5kID0gXCJpbmZvXCIpID0+IHNldFRvYXN0KHsgdGV4dCwga2luZCB9KTtcblxuICBhc3luYyBmdW5jdGlvbiBvbkNoZWNrVXBkYXRlcygpIHtcbiAgICB0cnkge1xuICAgICAgc2hvdyhcIkNoZWNraW5nIGZvciB1cGRhdGVz4oCmXCIsIFwiaW5mb1wiKTtcblxuICAgICAgLy8gQXNrIG1haW4gZm9yIGN1cnJlbnQgdmVyc2lvbiBhbmQgYW4gdXBkYXRlIGNoZWNrIHJlc3VsdFxuICAgICAgY29uc3QgY3VycmVudCA9IGF3YWl0IHdpbmRvdy5hcHA/LmdldFZlcnNpb24/LigpLmNhdGNoKCgpID0+IG51bGwpO1xuICAgICAgY29uc3QgcmVzID0gYXdhaXQgd2luZG93LmFwcD8uY2hlY2tVcGRhdGVzPy4oKTtcblxuICAgICAgY29uc3Qgc3RhdHVzID0gcmVzPy5zdGF0dXMgfHwgKHJlcz8udmVyc2lvbiA/IFwiYXZhaWxhYmxlXCIgOiBcInVwdG9kYXRlXCIpO1xuXG4gICAgICBpZiAoc3RhdHVzID09PSBcImF2YWlsYWJsZVwiICYmIHJlcz8udmVyc2lvbikge1xuICAgICAgICBzaG93KGBVcGRhdGUgJHtyZXMudmVyc2lvbn0gYXZhaWxhYmxlIOKAlCB3aWxsIGluc3RhbGwgb24gZXhpdC5gLCBcInN1Y2Nlc3NcIik7XG4gICAgICB9IGVsc2UgaWYgKHN0YXR1cyA9PT0gXCJ1cHRvZGF0ZVwiKSB7XG4gICAgICAgIHNob3coYFVwIHRvIGRhdGUke2N1cnJlbnQgPyBgICh2JHtjdXJyZW50fSlgIDogXCJcIn0hYCwgXCJzdWNjZXNzXCIpO1xuICAgICAgfSBlbHNlIGlmIChzdGF0dXMgPT09IFwiZXJyb3JcIikge1xuICAgICAgICBzaG93KFwiVXBkYXRlIGNoZWNrIGZhaWxlZC5cIiwgXCJlcnJvclwiKTtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIltPcHRpb25zTWVudV0gY2hlY2tVcGRhdGVzIGVycm9yOlwiLCByZXM/Lm1lc3NhZ2UpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2hvdyhcIlVwIHRvIGRhdGUhXCIsIFwic3VjY2Vzc1wiKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIHNob3coXCJVcGRhdGUgY2hlY2sgZmFpbGVkLlwiLCBcImVycm9yXCIpO1xuICAgICAgY29uc29sZS5lcnJvcihcIltPcHRpb25zTWVudV0gY2hlY2tVcGRhdGVzIGVycm9yOlwiLCBlcnIpO1xuICAgIH0gZmluYWxseSB7XG4gICAgICBzZXRPcGVuKGZhbHNlKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBmdW5jdGlvbiBvblJlbG9hZE9DUigpIHtcbiAgICB0cnkge1xuICAgICAgc2hvdyhcIlJlc3RhcnRpbmcgT0NS4oCmXCIsIFwiaW5mb1wiKTtcbiAgICAgIGF3YWl0IHdpbmRvdy5hcHA/LnJlbG9hZE9DUj8uKCk7XG4gICAgICAvLyBhc2sgTGl2ZSB0YWIgdG8gcmVjb25uZWN0ICYgY2xlYXIgY3VycmVudCBzdGF0ZVxuICAgICAgd2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KFwiZm9yY2UtbGl2ZS1yZWNvbm5lY3RcIiwgeyBkZXRhaWw6IHsgcmVzZXQ6IHRydWUgfSB9KSk7XG4gICAgICBzaG93KFwiT0NSIHJlc3RhcnRlZC5cIiwgXCJzdWNjZXNzXCIpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgc2hvdyhcIkZhaWxlZCB0byByZXN0YXJ0IE9DUi5cIiwgXCJlcnJvclwiKTtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJbT3B0aW9uc01lbnVdIHJlbG9hZE9DUiBlcnJvcjpcIiwgZXJyKTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgc2V0T3BlbihmYWxzZSk7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZnVuY3Rpb24gb25SZWZyZXNoKCkge1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCB3aW5kb3cuYXBwPy5yZWZyZXNoQXBwPy4oKTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgc2V0T3BlbihmYWxzZSk7XG4gICAgfVxuICB9XG5cbiAgLy8gU3R5bGVzXG4gIGNvbnN0IGJ0blN0eWxlID0ge1xuICAgIHBhZGRpbmc6IFwiNnB4IDEwcHhcIixcbiAgICBib3JkZXJSYWRpdXM6IDEwLFxuICAgIGJvcmRlcjogXCIxcHggc29saWQgIzJhMmEyYVwiLFxuICAgIGJhY2tncm91bmQ6IFwibGluZWFyLWdyYWRpZW50KDE4MGRlZywjMmIyYjJiLCMxYjFiMWIpXCIsXG4gICAgY29sb3I6IFwiI2VhZWFlYVwiLFxuICAgIGZvbnRXZWlnaHQ6IDcwMCxcbiAgICBjdXJzb3I6IFwicG9pbnRlclwiLFxuICAgIGJveFNoYWRvdzogXCIwIDRweCAxNnB4IHJnYmEoMCwwLDAsLjMpXCIsXG4gIH07XG4gIGNvbnN0IG1lbnVTdHlsZSA9IHtcbiAgICBwb3NpdGlvbjogXCJhYnNvbHV0ZVwiLFxuICAgIHJpZ2h0OiAwLFxuICAgIHRvcDogXCJjYWxjKDEwMCUgKyA2cHgpXCIsXG4gICAgbWluV2lkdGg6IDIyMCxcbiAgICBiYWNrZ3JvdW5kOiBcIiMwZTBlMGVcIixcbiAgICBib3JkZXI6IFwiMXB4IHNvbGlkICMyODI4MjhcIixcbiAgICBib3JkZXJSYWRpdXM6IDEyLFxuICAgIGJveFNoYWRvdzogXCIwIDE2cHggNDBweCByZ2JhKDAsMCwwLC40NSlcIixcbiAgICBvdmVyZmxvdzogXCJoaWRkZW5cIixcbiAgfTtcblxuICByZXR1cm4gKFxuICAgIDxkaXYgcmVmPXttZW51UmVmfSBzdHlsZT17eyBwb3NpdGlvbjogXCJmaXhlZFwiLCB0b3A6IDEwLCByaWdodDogMTIsIHpJbmRleDogOTk5OSB9fT5cbiAgICAgIDxidXR0b25cbiAgICAgICAgc3R5bGU9e2J0blN0eWxlfVxuICAgICAgICBvbkNsaWNrPXsoKSA9PiBzZXRPcGVuKCh2KSA9PiAhdil9XG4gICAgICAgIHRpdGxlPVwiT3B0aW9uc1wiXG4gICAgICAgIGFyaWEtaGFzcG9wdXA9XCJtZW51XCJcbiAgICAgICAgYXJpYS1leHBhbmRlZD17b3Blbn1cbiAgICAgID5cbiAgICAgICAgT3B0aW9ucyDilr5cbiAgICAgIDwvYnV0dG9uPlxuXG4gICAgICB7b3BlbiAmJiAoXG4gICAgICAgIDxkaXYgc3R5bGU9e21lbnVTdHlsZX0gcm9sZT1cIm1lbnVcIiBhcmlhLWxhYmVsPVwiT3B0aW9ucyBtZW51XCI+XG4gICAgICAgICAgPE1lbnVJdGVtIGxhYmVsPVwiQ2hlY2sgZm9yIHVwZGF0ZXNcIiBvbkNsaWNrPXtvbkNoZWNrVXBkYXRlc30gLz5cbiAgICAgICAgICA8RGl2aWRlciAvPlxuICAgICAgICAgIDxNZW51SXRlbSBsYWJlbD1cIkxpdmUgT0NSIFNldHVw4oCmXCIgb25DbGljaz17KCk9Pnsgd2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KFwib3Blbi1saXZlLXNldHVwXCIpKTsgc2V0T3BlbihmYWxzZSk7IH19IC8+XG4gICAgICAgICAgPE1lbnVJdGVtIGxhYmVsPVwiUmVsb2FkIE9DUlwiIG9uQ2xpY2s9e29uUmVsb2FkT0NSfSAvPlxuICAgICAgICAgIDxNZW51SXRlbSBsYWJlbD1cIlJlZnJlc2ggYXBwXCIgb25DbGljaz17b25SZWZyZXNofSAvPlxuICAgICAgICA8L2Rpdj5cbiAgICAgICl9XG5cbiAgICAgIHt0b2FzdCAmJiAoXG4gICAgICAgIDxkaXZcbiAgICAgICAgICByb2xlPVwic3RhdHVzXCJcbiAgICAgICAgICBhcmlhLWxpdmU9XCJwb2xpdGVcIlxuICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICBwb3NpdGlvbjogXCJhYnNvbHV0ZVwiLFxuICAgICAgICAgICAgcmlnaHQ6IDAsXG4gICAgICAgICAgICB0b3A6IFwiY2FsYygxMDAlICsgNTRweClcIixcbiAgICAgICAgICAgIHBhZGRpbmc6IFwiOHB4IDEycHhcIixcbiAgICAgICAgICAgIGJhY2tncm91bmQ6XG4gICAgICAgICAgICAgIHRvYXN0LmtpbmQgPT09IFwiZXJyb3JcIlxuICAgICAgICAgICAgICAgID8gXCIjNWExYTFhXCJcbiAgICAgICAgICAgICAgICA6IHRvYXN0LmtpbmQgPT09IFwic3VjY2Vzc1wiXG4gICAgICAgICAgICAgICAgPyBcIiMxYjRhMWJcIlxuICAgICAgICAgICAgICAgIDogXCIjMWExYTNhXCIsXG4gICAgICAgICAgICBjb2xvcjogXCIjZWVlXCIsXG4gICAgICAgICAgICBib3JkZXJSYWRpdXM6IDEwLFxuICAgICAgICAgICAgYm9yZGVyOiBcIjFweCBzb2xpZCAjMzMzXCIsXG4gICAgICAgICAgICBib3hTaGFkb3c6IFwiMCA4cHggMjhweCByZ2JhKDAsMCwwLC40NSlcIixcbiAgICAgICAgICAgIG1heFdpZHRoOiAzNjAsXG4gICAgICAgICAgICBwb2ludGVyRXZlbnRzOiBcIm5vbmVcIixcbiAgICAgICAgICAgIGZvbnRXZWlnaHQ6IDcwMCxcbiAgICAgICAgICB9fVxuICAgICAgICA+XG4gICAgICAgICAge3RvYXN0LnRleHR9XG4gICAgICAgIDwvZGl2PlxuICAgICAgKX1cbiAgICA8L2Rpdj5cbiAgKTtcbn1cblxuZnVuY3Rpb24gTWVudUl0ZW0oeyBsYWJlbCwgb25DbGljayB9KSB7XG4gIGNvbnN0IFtob3Zlciwgc2V0SG92ZXJdID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBpdGVtU3R5bGUgPSB7XG4gICAgd2lkdGg6IFwiMTAwJVwiLFxuICAgIHRleHRBbGlnbjogXCJsZWZ0XCIsXG4gICAgcGFkZGluZzogXCIxMHB4IDEycHhcIixcbiAgICBjb2xvcjogXCIjZGRkXCIsXG4gICAgYmFja2dyb3VuZDogXCJ0cmFuc3BhcmVudFwiLFxuICAgIGJvcmRlcjogMCxcbiAgICBjdXJzb3I6IFwicG9pbnRlclwiLFxuICAgIGZvbnRXZWlnaHQ6IDYwMCxcbiAgfTtcbiAgY29uc3QgaXRlbUhvdmVyID0geyBiYWNrZ3JvdW5kOiBcIiMxYjFiMWJcIiB9O1xuICByZXR1cm4gKFxuICAgIDxidXR0b25cbiAgICAgIHJvbGU9XCJtZW51aXRlbVwiXG4gICAgICBvbkNsaWNrPXtvbkNsaWNrfVxuICAgICAgb25Nb3VzZUVudGVyPXsoKSA9PiBzZXRIb3Zlcih0cnVlKX1cbiAgICAgIG9uTW91c2VMZWF2ZT17KCkgPT4gc2V0SG92ZXIoZmFsc2UpfVxuICAgICAgc3R5bGU9e3sgLi4uaXRlbVN0eWxlLCAuLi4oaG92ZXIgPyBpdGVtSG92ZXIgOiBudWxsKSB9fVxuICAgID5cbiAgICAgIHtsYWJlbH1cbiAgICA8L2J1dHRvbj5cbiAgKTtcbn1cblxuZnVuY3Rpb24gRGl2aWRlcigpIHtcbiAgcmV0dXJuIDxkaXYgc3R5bGU9e3sgaGVpZ2h0OiAxLCBiYWNrZ3JvdW5kOiBcIiMyNjI2MjZcIiB9fSAvPjtcbn1cbiJdLCJmaWxlIjoiQzovZGV2L3Bva2VtbW8tdG9vbC9zcmMvY29tcG9uZW50cy9PcHRpb25zTWVudS5qc3gifQ==