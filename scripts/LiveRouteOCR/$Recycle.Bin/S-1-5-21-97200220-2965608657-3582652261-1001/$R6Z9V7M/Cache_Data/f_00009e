import { createHotContext as __vite__createHotContext } from "/@vite/client";import.meta.hot = __vite__createHotContext("/src/components/OptionsMenu.jsx");import __vite__cjsImport0_react_jsxDevRuntime from "/node_modules/.vite/deps/react_jsx-dev-runtime.js?v=992e703d"; const jsxDEV = __vite__cjsImport0_react_jsxDevRuntime["jsxDEV"];
import * as RefreshRuntime from "/@react-refresh";
const inWebWorker = typeof WorkerGlobalScope !== "undefined" && self instanceof WorkerGlobalScope;
let prevRefreshReg;
let prevRefreshSig;
if (import.meta.hot && !inWebWorker) {
  if (!window.$RefreshReg$) {
    throw new Error(
      "@vitejs/plugin-react can't detect preamble. Something is wrong."
    );
  }
  prevRefreshReg = window.$RefreshReg$;
  prevRefreshSig = window.$RefreshSig$;
  window.$RefreshReg$ = RefreshRuntime.getRefreshReg("C:/dev/pokemmo-tool/src/components/OptionsMenu.jsx");
  window.$RefreshSig$ = RefreshRuntime.createSignatureFunctionForTransform;
}
var _s = $RefreshSig$(), _s2 = $RefreshSig$();
import __vite__cjsImport3_react from "/node_modules/.vite/deps/react.js?v=992e703d"; const React = __vite__cjsImport3_react.__esModule ? __vite__cjsImport3_react.default : __vite__cjsImport3_react; const useEffect = __vite__cjsImport3_react["useEffect"]; const useRef = __vite__cjsImport3_react["useRef"]; const useState = __vite__cjsImport3_react["useState"];
export default function OptionsMenu({ style = {} }) {
  _s();
  const [open, setOpen] = useState(false);
  const [toast, setToast] = useState(null);
  const menuRef = useRef(null);
  useEffect(() => {
    const onDoc = (e) => {
      if (menuRef.current && !menuRef.current.contains(e.target)) setOpen(false);
    };
    document.addEventListener("mousedown", onDoc);
    return () => document.removeEventListener("mousedown", onDoc);
  }, []);
  useEffect(() => {
    if (!toast) return;
    const t = setTimeout(() => setToast(null), 2200);
    return () => clearTimeout(t);
  }, [toast]);
  const show = (text, kind = "info") => setToast({ text, kind });
  useEffect(() => {
    const off = window.app?.onUpdateDownloaded?.((ver) => {
      show(`Update ${ver} downloaded — restart to apply.`, "info");
    });
    return () => {
      try {
        off?.();
      } catch {
      }
    };
  }, []);
  async function onCheckUpdates() {
    try {
      show("Checking for updates…", "info");
      const current = await window.app?.getVersion?.().catch(() => null);
      const res = await window.app?.checkUpdates?.();
      const status = res?.status || "uptodate";
      if (status === "downloaded" && res?.version) {
        show(`Update ${res.version} downloaded — restart to apply.`, "success");
      } else if (status === "downloading" && res?.version) {
        show(`Downloading update ${res.version}…`, "info");
      } else if (status === "uptodate") {
        show(`Up to date${current ? ` (v${current})` : ""}!`, "success");
      } else if (status === "error") {
        show("Update check failed.", "error");
        console.error("[OptionsMenu] checkUpdates error:", res?.message);
      } else {
        show("Up to date!", "success");
      }
    } catch (err) {
      show("Update check failed.", "error");
      console.error("[OptionsMenu] checkUpdates error:", err);
    } finally {
      setOpen(false);
    }
  }
  async function onReloadOCR() {
    try {
      show("Restarting OCR…", "info");
      await window.app?.reloadOCR?.();
      window.dispatchEvent(new CustomEvent("force-live-reconnect", { detail: { reset: true } }));
      show("OCR restarted.", "success");
    } catch (err) {
      show("Failed to restart OCR.", "error");
      console.error("[OptionsMenu] reloadOCR error:", err);
    } finally {
      setOpen(false);
    }
  }
  async function onRefresh() {
    try {
      await window.app?.refreshApp?.();
    } finally {
      setOpen(false);
    }
  }
  const btnStyle = {
    padding: "6px 10px",
    borderRadius: 10,
    border: "1px solid #2a2a2a",
    background: "linear-gradient(180deg,#2b2b2b,#1b1b1b)",
    color: "#eaeaea",
    fontWeight: 700,
    cursor: "pointer",
    boxShadow: "0 4px 16px rgba(0,0,0,.3)"
  };
  const menuStyle = {
    position: "absolute",
    right: 0,
    top: "calc(100% + 6px)",
    minWidth: 220,
    background: "#0e0e0e",
    border: "1px solid #282828",
    borderRadius: 12,
    boxShadow: "0 16px 40px rgba(0,0,0,.45)",
    overflow: "hidden"
  };
  return /* @__PURE__ */ jsxDEV("div", { ref: menuRef, style: { position: "relative", ...style }, children: [
    /* @__PURE__ */ jsxDEV(
      "button",
      {
        style: btnStyle,
        onClick: () => setOpen((v) => !v),
        title: "Options",
        "aria-haspopup": "menu",
        "aria-expanded": open,
        children: "Options ▾"
      },
      void 0,
      false,
      {
        fileName: "C:/dev/pokemmo-tool/src/components/OptionsMenu.jsx",
        lineNumber: 136,
        columnNumber: 7
      },
      this
    ),
    open && /* @__PURE__ */ jsxDEV("div", { style: menuStyle, role: "menu", "aria-label": "Options menu", children: [
      /* @__PURE__ */ jsxDEV(MenuItem, { label: "Check for updates", onClick: onCheckUpdates }, void 0, false, {
        fileName: "C:/dev/pokemmo-tool/src/components/OptionsMenu.jsx",
        lineNumber: 148,
        columnNumber: 11
      }, this),
      /* @__PURE__ */ jsxDEV(Divider, {}, void 0, false, {
        fileName: "C:/dev/pokemmo-tool/src/components/OptionsMenu.jsx",
        lineNumber: 149,
        columnNumber: 11
      }, this),
      /* @__PURE__ */ jsxDEV(MenuItem, { label: "Reload OCR", onClick: onReloadOCR }, void 0, false, {
        fileName: "C:/dev/pokemmo-tool/src/components/OptionsMenu.jsx",
        lineNumber: 150,
        columnNumber: 11
      }, this),
      /* @__PURE__ */ jsxDEV(MenuItem, { label: "Refresh app", onClick: onRefresh }, void 0, false, {
        fileName: "C:/dev/pokemmo-tool/src/components/OptionsMenu.jsx",
        lineNumber: 151,
        columnNumber: 11
      }, this)
    ] }, void 0, true, {
      fileName: "C:/dev/pokemmo-tool/src/components/OptionsMenu.jsx",
      lineNumber: 147,
      columnNumber: 7
    }, this),
    toast && /* @__PURE__ */ jsxDEV(
      "div",
      {
        role: "status",
        "aria-live": "polite",
        style: {
          position: "absolute",
          right: 0,
          top: "calc(100% + 54px)",
          padding: "8px 12px",
          background: toast.kind === "error" ? "#5a1a1a" : toast.kind === "success" ? "#1b4a1b" : "#1a1a3a",
          color: "#eee",
          borderRadius: 10,
          border: "1px solid #333",
          boxShadow: "0 8px 28px rgba(0,0,0,.45)",
          maxWidth: 360,
          pointerEvents: "none",
          fontWeight: 700
        },
        children: toast.text
      },
      void 0,
      false,
      {
        fileName: "C:/dev/pokemmo-tool/src/components/OptionsMenu.jsx",
        lineNumber: 156,
        columnNumber: 7
      },
      this
    )
  ] }, void 0, true, {
    fileName: "C:/dev/pokemmo-tool/src/components/OptionsMenu.jsx",
    lineNumber: 135,
    columnNumber: 5
  }, this);
}
_s(OptionsMenu, "8037qpmeKww5azz1EVkftMctLu8=");
_c = OptionsMenu;
function MenuItem({ label, onClick }) {
  _s2();
  const [hover, setHover] = useState(false);
  const itemStyle = {
    width: "100%",
    textAlign: "left",
    padding: "10px 12px",
    color: "#ddd",
    background: "transparent",
    border: 0,
    cursor: "pointer",
    fontWeight: 600
  };
  const itemHover = { background: "#1b1b1b" };
  return /* @__PURE__ */ jsxDEV(
    "button",
    {
      role: "menuitem",
      onClick,
      onMouseEnter: () => setHover(true),
      onMouseLeave: () => setHover(false),
      style: { ...itemStyle, ...hover ? itemHover : null },
      children: label
    },
    void 0,
    false,
    {
      fileName: "C:/dev/pokemmo-tool/src/components/OptionsMenu.jsx",
      lineNumber: 200,
      columnNumber: 5
    },
    this
  );
}
_s2(MenuItem, "bRXmKus9fOZFlca/6zXTYU+twGY=");
_c2 = MenuItem;
function Divider() {
  return /* @__PURE__ */ jsxDEV("div", { style: { height: 1, background: "#262626" } }, void 0, false, {
    fileName: "C:/dev/pokemmo-tool/src/components/OptionsMenu.jsx",
    lineNumber: 213,
    columnNumber: 10
  }, this);
}
_c3 = Divider;
var _c, _c2, _c3;
$RefreshReg$(_c, "OptionsMenu");
$RefreshReg$(_c2, "MenuItem");
$RefreshReg$(_c3, "Divider");
if (import.meta.hot && !inWebWorker) {
  window.$RefreshReg$ = prevRefreshReg;
  window.$RefreshSig$ = prevRefreshSig;
}
if (import.meta.hot && !inWebWorker) {
  RefreshRuntime.__hmr_import(import.meta.url).then((currentExports) => {
    RefreshRuntime.registerExportsForReactRefresh("C:/dev/pokemmo-tool/src/components/OptionsMenu.jsx", currentExports);
    import.meta.hot.accept((nextExports) => {
      if (!nextExports) return;
      const invalidateMessage = RefreshRuntime.validateRefreshBoundaryAndEnqueueUpdate("C:/dev/pokemmo-tool/src/components/OptionsMenu.jsx", currentExports, nextExports);
      if (invalidateMessage) import.meta.hot.invalidate(invalidateMessage);
    });
  });
}

//# sourceMappingURL=data:application/json;base64,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O0FBQUEsSUFDUEMsV0FBVztBQUFBLElBQ1gxQixTQUFTO0FBQUEsSUFDVEksT0FBTztBQUFBLElBQ1BELFlBQVk7QUFBQSxJQUNaRCxRQUFRO0FBQUEsSUFDUkksUUFBUTtBQUFBLElBQ1JELFlBQVk7QUFBQSxFQUNkO0FBQ0EsUUFBTXNCLFlBQVksRUFBRXhCLFlBQVksVUFBVTtBQUMxQyxTQUNFO0FBQUEsSUFBQztBQUFBO0FBQUEsTUFDQyxNQUFLO0FBQUEsTUFDTDtBQUFBLE1BQ0EsY0FBYyxNQUFNb0IsU0FBUyxJQUFJO0FBQUEsTUFDakMsY0FBYyxNQUFNQSxTQUFTLEtBQUs7QUFBQSxNQUNsQyxPQUFPLEVBQUUsR0FBR0MsV0FBVyxHQUFJRixRQUFRSyxZQUFZLEtBQU07QUFBQSxNQUVwRFI7QUFBQUE7QUFBQUEsSUFQSDtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFRQTtBQUVKO0FBQUNFLElBeEJRSCxVQUFRO0FBQUFVLE1BQVJWO0FBMEJULFNBQVNXLFVBQVU7QUFDakIsU0FBTyx1QkFBQyxTQUFJLE9BQU8sRUFBRUMsUUFBUSxHQUFHM0IsWUFBWSxVQUFVLEtBQS9DO0FBQUE7QUFBQTtBQUFBO0FBQUEsU0FBaUQ7QUFDMUQ7QUFBQzRCLE1BRlFGO0FBQU8sSUFBQVosSUFBQVcsS0FBQUc7QUFBQUMsYUFBQWYsSUFBQTtBQUFBZSxhQUFBSixLQUFBO0FBQUFJLGFBQUFELEtBQUEiLCJuYW1lcyI6WyJSZWFjdCIsInVzZUVmZmVjdCIsInVzZVJlZiIsInVzZVN0YXRlIiwiT3B0aW9uc01lbnUiLCJzdHlsZSIsIl9zIiwib3BlbiIsInNldE9wZW4iLCJ0b2FzdCIsInNldFRvYXN0IiwibWVudVJlZiIsIm9uRG9jIiwiZSIsImN1cnJlbnQiLCJjb250YWlucyIsInRhcmdldCIsImRvY3VtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJ0Iiwic2V0VGltZW91dCIsImNsZWFyVGltZW91dCIsInNob3ciLCJ0ZXh0Iiwia2luZCIsIm9mZiIsIndpbmRvdyIsImFwcCIsIm9uVXBkYXRlRG93bmxvYWRlZCIsInZlciIsIm9uQ2hlY2tVcGRhdGVzIiwiZ2V0VmVyc2lvbiIsImNhdGNoIiwicmVzIiwiY2hlY2tVcGRhdGVzIiwic3RhdHVzIiwidmVyc2lvbiIsImNvbnNvbGUiLCJlcnJvciIsIm1lc3NhZ2UiLCJlcnIiLCJvblJlbG9hZE9DUiIsInJlbG9hZE9DUiIsImRpc3BhdGNoRXZlbnQiLCJDdXN0b21FdmVudCIsImRldGFpbCIsInJlc2V0Iiwib25SZWZyZXNoIiwicmVmcmVzaEFwcCIsImJ0blN0eWxlIiwicGFkZGluZyIsImJvcmRlclJhZGl1cyIsImJvcmRlciIsImJhY2tncm91bmQiLCJjb2xvciIsImZvbnRXZWlnaHQiLCJjdXJzb3IiLCJib3hTaGFkb3ciLCJtZW51U3R5bGUiLCJwb3NpdGlvbiIsInJpZ2h0IiwidG9wIiwibWluV2lkdGgiLCJvdmVyZmxvdyIsInYiLCJtYXhXaWR0aCIsInBvaW50ZXJFdmVudHMiLCJfYyIsIk1lbnVJdGVtIiwibGFiZWwiLCJvbkNsaWNrIiwiX3MyIiwiaG92ZXIiLCJzZXRIb3ZlciIsIml0ZW1TdHlsZSIsIndpZHRoIiwidGV4dEFsaWduIiwiaXRlbUhvdmVyIiwiX2MyIiwiRGl2aWRlciIsImhlaWdodCIsIl9jMyIsIiRSZWZyZXNoUmVnJCJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlcyI6WyJPcHRpb25zTWVudS5qc3giXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7IHVzZUVmZmVjdCwgdXNlUmVmLCB1c2VTdGF0ZSB9IGZyb20gXCJyZWFjdFwiO1xuXG4vKipcbiAqIE9wdGlvbnMgZHJvcGRvd24gd2l0aCB0b2FzdHM6XG4gKiAgLSBDaGVjayBmb3IgdXBkYXRlcyDihpIgXCJDaGVja2luZ+KAplwiLCBcIlVwIHRvIGRhdGUgKHZYKSFcIiwgXCJEb3dubG9hZGluZyB1cGRhdGUgdlnigKZcIiwgb3IgXCJVcGRhdGUgdlkgZG93bmxvYWRlZCDigJQgcmVzdGFydCB0byBhcHBseS5cIlxuICogIC0gUmVsb2FkIE9DUiAgICAgICAg4oaSIHJlc3RhcnRzIGhlbHBlciBBTkQgc2lnbmFscyBMaXZlIHRhYiB0byByZWNvbm5lY3QvY2xlYXJcbiAqICAtIFJlZnJlc2ggYXBwICAgICAgIOKGkiBmdWxsIHJlbmRlcmVyIHJlZnJlc2hcbiAqL1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gT3B0aW9uc01lbnUoeyBzdHlsZSA9IHt9IH0pIHtcbiAgY29uc3QgW29wZW4sIHNldE9wZW5dID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbdG9hc3QsIHNldFRvYXN0XSA9IHVzZVN0YXRlKG51bGwpOyAvLyB7IHRleHQsIGtpbmQgfSB8IG51bGxcbiAgY29uc3QgbWVudVJlZiA9IHVzZVJlZihudWxsKTtcblxuICAvLyBjbG9zZSB3aGVuIGNsaWNraW5nIG91dHNpZGVcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBjb25zdCBvbkRvYyA9IChlKSA9PiB7XG4gICAgICBpZiAobWVudVJlZi5jdXJyZW50ICYmICFtZW51UmVmLmN1cnJlbnQuY29udGFpbnMoZS50YXJnZXQpKSBzZXRPcGVuKGZhbHNlKTtcbiAgICB9O1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgb25Eb2MpO1xuICAgIHJldHVybiAoKSA9PiBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIG9uRG9jKTtcbiAgfSwgW10pO1xuXG4gIC8vIGF1dG8taGlkZSB0b2FzdFxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmICghdG9hc3QpIHJldHVybjtcbiAgICBjb25zdCB0ID0gc2V0VGltZW91dCgoKSA9PiBzZXRUb2FzdChudWxsKSwgMjIwMCk7XG4gICAgcmV0dXJuICgpID0+IGNsZWFyVGltZW91dCh0KTtcbiAgfSwgW3RvYXN0XSk7XG5cbiAgY29uc3Qgc2hvdyA9ICh0ZXh0LCBraW5kID0gXCJpbmZvXCIpID0+IHNldFRvYXN0KHsgdGV4dCwga2luZCB9KTtcbiAgXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgY29uc3Qgb2ZmID0gd2luZG93LmFwcD8ub25VcGRhdGVEb3dubG9hZGVkPy4oKHZlcikgPT4ge1xuICAgICAgc2hvdyhgVXBkYXRlICR7dmVyfSBkb3dubG9hZGVkIOKAlCByZXN0YXJ0IHRvIGFwcGx5LmAsIFwiaW5mb1wiKTtcbiAgICB9KTtcbiAgICByZXR1cm4gKCkgPT4geyB0cnkgeyBvZmY/LigpOyB9IGNhdGNoIHt9IH07XG4gIH0sIFtdKTtcblxuICBhc3luYyBmdW5jdGlvbiBvbkNoZWNrVXBkYXRlcygpIHtcbiAgICB0cnkge1xuICAgICAgc2hvdyhcIkNoZWNraW5nIGZvciB1cGRhdGVz4oCmXCIsIFwiaW5mb1wiKTtcblxuICAgICAgLy8gQXNrIG1haW4gZm9yIGN1cnJlbnQgdmVyc2lvbiBhbmQgYW4gdXBkYXRlIGNoZWNrIHJlc3VsdFxuICAgICAgY29uc3QgY3VycmVudCA9IGF3YWl0IHdpbmRvdy5hcHA/LmdldFZlcnNpb24/LigpLmNhdGNoKCgpID0+IG51bGwpO1xuICAgICAgY29uc3QgcmVzID0gYXdhaXQgd2luZG93LmFwcD8uY2hlY2tVcGRhdGVzPy4oKTtcblxuICAgICAgY29uc3Qgc3RhdHVzID0gcmVzPy5zdGF0dXMgfHwgXCJ1cHRvZGF0ZVwiO1xuXG4gICAgICBpZiAoc3RhdHVzID09PSBcImRvd25sb2FkZWRcIiAmJiByZXM/LnZlcnNpb24pIHtcbiAgICAgICAgc2hvdyhgVXBkYXRlICR7cmVzLnZlcnNpb259IGRvd25sb2FkZWQg4oCUIHJlc3RhcnQgdG8gYXBwbHkuYCwgXCJzdWNjZXNzXCIpO1xuICAgICAgfSBlbHNlIGlmIChzdGF0dXMgPT09IFwiZG93bmxvYWRpbmdcIiAmJiByZXM/LnZlcnNpb24pIHtcbiAgICAgICAgc2hvdyhgRG93bmxvYWRpbmcgdXBkYXRlICR7cmVzLnZlcnNpb2594oCmYCwgXCJpbmZvXCIpO1xuICAgICAgfSBlbHNlIGlmIChzdGF0dXMgPT09IFwidXB0b2RhdGVcIikge1xuICAgICAgICBzaG93KGBVcCB0byBkYXRlJHtjdXJyZW50ID8gYCAodiR7Y3VycmVudH0pYCA6IFwiXCJ9IWAsIFwic3VjY2Vzc1wiKTtcbiAgICAgIH0gZWxzZSBpZiAoc3RhdHVzID09PSBcImVycm9yXCIpIHtcbiAgICAgICAgc2hvdyhcIlVwZGF0ZSBjaGVjayBmYWlsZWQuXCIsIFwiZXJyb3JcIik7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJbT3B0aW9uc01lbnVdIGNoZWNrVXBkYXRlcyBlcnJvcjpcIiwgcmVzPy5tZXNzYWdlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNob3coXCJVcCB0byBkYXRlIVwiLCBcInN1Y2Nlc3NcIik7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBzaG93KFwiVXBkYXRlIGNoZWNrIGZhaWxlZC5cIiwgXCJlcnJvclwiKTtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJbT3B0aW9uc01lbnVdIGNoZWNrVXBkYXRlcyBlcnJvcjpcIiwgZXJyKTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgc2V0T3BlbihmYWxzZSk7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZnVuY3Rpb24gb25SZWxvYWRPQ1IoKSB7XG4gICAgdHJ5IHtcbiAgICAgIHNob3coXCJSZXN0YXJ0aW5nIE9DUuKAplwiLCBcImluZm9cIik7XG4gICAgICBhd2FpdCB3aW5kb3cuYXBwPy5yZWxvYWRPQ1I/LigpO1xuICAgICAgLy8gYXNrIExpdmUgdGFiIHRvIHJlY29ubmVjdCAmIGNsZWFyIGN1cnJlbnQgc3RhdGVcbiAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudChcImZvcmNlLWxpdmUtcmVjb25uZWN0XCIsIHsgZGV0YWlsOiB7IHJlc2V0OiB0cnVlIH0gfSkpO1xuICAgICAgc2hvdyhcIk9DUiByZXN0YXJ0ZWQuXCIsIFwic3VjY2Vzc1wiKTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIHNob3coXCJGYWlsZWQgdG8gcmVzdGFydCBPQ1IuXCIsIFwiZXJyb3JcIik7XG4gICAgICBjb25zb2xlLmVycm9yKFwiW09wdGlvbnNNZW51XSByZWxvYWRPQ1IgZXJyb3I6XCIsIGVycik7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHNldE9wZW4oZmFsc2UpO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGZ1bmN0aW9uIG9uUmVmcmVzaCgpIHtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgd2luZG93LmFwcD8ucmVmcmVzaEFwcD8uKCk7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHNldE9wZW4oZmFsc2UpO1xuICAgIH1cbiAgfVxuXG4gIC8vIFN0eWxlc1xuICBjb25zdCBidG5TdHlsZSA9IHtcbiAgICBwYWRkaW5nOiBcIjZweCAxMHB4XCIsXG4gICAgYm9yZGVyUmFkaXVzOiAxMCxcbiAgICBib3JkZXI6IFwiMXB4IHNvbGlkICMyYTJhMmFcIixcbiAgICBiYWNrZ3JvdW5kOiBcImxpbmVhci1ncmFkaWVudCgxODBkZWcsIzJiMmIyYiwjMWIxYjFiKVwiLFxuICAgIGNvbG9yOiBcIiNlYWVhZWFcIixcbiAgICBmb250V2VpZ2h0OiA3MDAsXG4gICAgY3Vyc29yOiBcInBvaW50ZXJcIixcbiAgICBib3hTaGFkb3c6IFwiMCA0cHggMTZweCByZ2JhKDAsMCwwLC4zKVwiLFxuICB9O1xuICBjb25zdCBtZW51U3R5bGUgPSB7XG4gICAgcG9zaXRpb246IFwiYWJzb2x1dGVcIixcbiAgICByaWdodDogMCxcbiAgICB0b3A6IFwiY2FsYygxMDAlICsgNnB4KVwiLFxuICAgIG1pbldpZHRoOiAyMjAsXG4gICAgYmFja2dyb3VuZDogXCIjMGUwZTBlXCIsXG4gICAgYm9yZGVyOiBcIjFweCBzb2xpZCAjMjgyODI4XCIsXG4gICAgYm9yZGVyUmFkaXVzOiAxMixcbiAgICBib3hTaGFkb3c6IFwiMCAxNnB4IDQwcHggcmdiYSgwLDAsMCwuNDUpXCIsXG4gICAgb3ZlcmZsb3c6IFwiaGlkZGVuXCIsXG4gIH07XG5cbiAgcmV0dXJuIChcbiAgICA8ZGl2IHJlZj17bWVudVJlZn0gc3R5bGU9e3sgcG9zaXRpb246IFwicmVsYXRpdmVcIiwgLi4uc3R5bGUgfX0+XG4gICAgICA8YnV0dG9uXG4gICAgICAgIHN0eWxlPXtidG5TdHlsZX1cbiAgICAgICAgb25DbGljaz17KCkgPT4gc2V0T3BlbigodikgPT4gIXYpfVxuICAgICAgICB0aXRsZT1cIk9wdGlvbnNcIlxuICAgICAgICBhcmlhLWhhc3BvcHVwPVwibWVudVwiXG4gICAgICAgIGFyaWEtZXhwYW5kZWQ9e29wZW59XG4gICAgICA+XG4gICAgICAgIE9wdGlvbnMg4pa+XG4gICAgICA8L2J1dHRvbj5cblxuICAgICAge29wZW4gJiYgKFxuICAgICAgICA8ZGl2IHN0eWxlPXttZW51U3R5bGV9IHJvbGU9XCJtZW51XCIgYXJpYS1sYWJlbD1cIk9wdGlvbnMgbWVudVwiPlxuICAgICAgICAgIDxNZW51SXRlbSBsYWJlbD1cIkNoZWNrIGZvciB1cGRhdGVzXCIgb25DbGljaz17b25DaGVja1VwZGF0ZXN9IC8+XG4gICAgICAgICAgPERpdmlkZXIgLz5cbiAgICAgICAgICA8TWVudUl0ZW0gbGFiZWw9XCJSZWxvYWQgT0NSXCIgb25DbGljaz17b25SZWxvYWRPQ1J9IC8+XG4gICAgICAgICAgPE1lbnVJdGVtIGxhYmVsPVwiUmVmcmVzaCBhcHBcIiBvbkNsaWNrPXtvblJlZnJlc2h9IC8+XG4gICAgICAgIDwvZGl2PlxuICAgICAgKX1cblxuICAgICAge3RvYXN0ICYmIChcbiAgICAgICAgPGRpdlxuICAgICAgICAgIHJvbGU9XCJzdGF0dXNcIlxuICAgICAgICAgIGFyaWEtbGl2ZT1cInBvbGl0ZVwiXG4gICAgICAgICAgc3R5bGU9e3tcbiAgICAgICAgICAgIHBvc2l0aW9uOiBcImFic29sdXRlXCIsXG4gICAgICAgICAgICByaWdodDogMCxcbiAgICAgICAgICAgIHRvcDogXCJjYWxjKDEwMCUgKyA1NHB4KVwiLFxuICAgICAgICAgICAgcGFkZGluZzogXCI4cHggMTJweFwiLFxuICAgICAgICAgICAgYmFja2dyb3VuZDpcbiAgICAgICAgICAgICAgdG9hc3Qua2luZCA9PT0gXCJlcnJvclwiXG4gICAgICAgICAgICAgICAgPyBcIiM1YTFhMWFcIlxuICAgICAgICAgICAgICAgIDogdG9hc3Qua2luZCA9PT0gXCJzdWNjZXNzXCJcbiAgICAgICAgICAgICAgICA/IFwiIzFiNGExYlwiXG4gICAgICAgICAgICAgICAgOiBcIiMxYTFhM2FcIixcbiAgICAgICAgICAgIGNvbG9yOiBcIiNlZWVcIixcbiAgICAgICAgICAgIGJvcmRlclJhZGl1czogMTAsXG4gICAgICAgICAgICBib3JkZXI6IFwiMXB4IHNvbGlkICMzMzNcIixcbiAgICAgICAgICAgIGJveFNoYWRvdzogXCIwIDhweCAyOHB4IHJnYmEoMCwwLDAsLjQ1KVwiLFxuICAgICAgICAgICAgbWF4V2lkdGg6IDM2MCxcbiAgICAgICAgICAgIHBvaW50ZXJFdmVudHM6IFwibm9uZVwiLFxuICAgICAgICAgICAgZm9udFdlaWdodDogNzAwLFxuICAgICAgICAgIH19XG4gICAgICAgID5cbiAgICAgICAgICB7dG9hc3QudGV4dH1cbiAgICAgICAgPC9kaXY+XG4gICAgICApfVxuICAgIDwvZGl2PlxuICApO1xufVxuXG5mdW5jdGlvbiBNZW51SXRlbSh7IGxhYmVsLCBvbkNsaWNrIH0pIHtcbiAgY29uc3QgW2hvdmVyLCBzZXRIb3Zlcl0gPSB1c2VTdGF0ZShmYWxzZSk7XG4gIGNvbnN0IGl0ZW1TdHlsZSA9IHtcbiAgICB3aWR0aDogXCIxMDAlXCIsXG4gICAgdGV4dEFsaWduOiBcImxlZnRcIixcbiAgICBwYWRkaW5nOiBcIjEwcHggMTJweFwiLFxuICAgIGNvbG9yOiBcIiNkZGRcIixcbiAgICBiYWNrZ3JvdW5kOiBcInRyYW5zcGFyZW50XCIsXG4gICAgYm9yZGVyOiAwLFxuICAgIGN1cnNvcjogXCJwb2ludGVyXCIsXG4gICAgZm9udFdlaWdodDogNjAwLFxuICB9O1xuICBjb25zdCBpdGVtSG92ZXIgPSB7IGJhY2tncm91bmQ6IFwiIzFiMWIxYlwiIH07XG4gIHJldHVybiAoXG4gICAgPGJ1dHRvblxuICAgICAgcm9sZT1cIm1lbnVpdGVtXCJcbiAgICAgIG9uQ2xpY2s9e29uQ2xpY2t9XG4gICAgICBvbk1vdXNlRW50ZXI9eygpID0+IHNldEhvdmVyKHRydWUpfVxuICAgICAgb25Nb3VzZUxlYXZlPXsoKSA9PiBzZXRIb3ZlcihmYWxzZSl9XG4gICAgICBzdHlsZT17eyAuLi5pdGVtU3R5bGUsIC4uLihob3ZlciA/IGl0ZW1Ib3ZlciA6IG51bGwpIH19XG4gICAgPlxuICAgICAge2xhYmVsfVxuICAgIDwvYnV0dG9uPlxuICApO1xufVxuXG5mdW5jdGlvbiBEaXZpZGVyKCkge1xuICByZXR1cm4gPGRpdiBzdHlsZT17eyBoZWlnaHQ6IDEsIGJhY2tncm91bmQ6IFwiIzI2MjYyNlwiIH19IC8+O1xufVxuIl0sImZpbGUiOiJDOi9kZXYvcG9rZW1tby10b29sL3NyYy9jb21wb25lbnRzL09wdGlvbnNNZW51LmpzeCJ9